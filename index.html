<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Arcade</title>
<style>
body { font-family: Arial, sans-serif; background:#111; color:#fff; margin:0; padding:0;}
nav { background:#222; padding:10px; display:flex; gap:10px;}
nav button { padding:6px 12px; background:#333; color:#fff; border:none; cursor:pointer; border-radius:4px;}
nav button:hover { background:#555; }
.panel { padding:20px; display:none;}
.panel.visible { display:block; }
#quiz-list, select { padding:6px; margin-top:6px; border-radius:4px; }
button { cursor:pointer; border-radius:4px; border:none; }
.question-block input { padding:4px; margin-bottom:4px; border-radius:4px; border:1px solid #555; width:100%; }
</style>
</head>
<body>

<nav>
  <button onclick="showPanel('view-play')">Play</button>
  <button onclick="showPanel('view-create')">Create Quiz</button>
</nav>

<!-- Play Panel -->
<section id="view-play" class="panel visible">
  <h2>Choose a Quiz</h2>
  <select id="quiz-list"></select>
  <h3>Choose Game Mode</h3>
  <button onclick="launchGame('runner')">3D Runner</button>
  <button onclick="launchGame('memory')">Memory Game</button>
</section>

<!-- Create Quiz Panel -->
<section id="view-create" class="panel">
  <h2>Create Your Own Quiz</h2>
  <input id="quiz-title" placeholder="Quiz title" style="margin-bottom:12px; width:100%;" />
  <div id="questions-container"></div>
  <button id="add-question" style="margin:12px 0;">+ Add Question</button>
  <div style="display:flex;gap:8px;">
    <button id="save-quiz">Save Quiz</button>
    <button id="clear-builder">Clear All</button>
  </div>
</section>

<!-- Placeholder for Games -->
<section id="game-container" class="panel">
  <h2 id="game-title"></h2>
  <div id="game-content">Game will appear here.</div>
  <button onclick="exitGame()">Exit Game</button>
</section>

<script>
// Panel switching
function showPanel(id){
  document.querySelectorAll('.panel').forEach(p=>p.classList.remove('visible'));
  document.getElementById(id).classList.add('visible');
}

// Quiz storage
let quizzes = JSON.parse(localStorage.getItem('quizarcade_quizzes_v3') || '[]');
const quizList = document.getElementById('quiz-list');
function refreshQuizList(){
  quizList.innerHTML='';
  quizzes.forEach(q=>{
    const opt = document.createElement('option');
    opt.value = q.id;
    opt.textContent = q.title;
    quizList.appendChild(opt);
  });
}
refreshQuizList();

// Dynamic quiz builder
const container = document.getElementById('questions-container');
function addQuestion(qText='', options=['','','',''], correct=0){
  const qDiv = document.createElement('div');
  qDiv.className='question-block';
  qDiv.style.border='1px solid rgba(255,255,255,0.1)';
  qDiv.style.padding='10px'; qDiv.style.marginBottom='10px'; qDiv.style.borderRadius='8px';
  
  qDiv.innerHTML = `
    <input type="text" class="q-text" placeholder="Enter question" value="${qText}">
    <div class="options-container"></div>
    <button class="remove-q" style="margin-top:6px;">Remove Question</button>
  `;
  
  const optionsContainer = qDiv.querySelector('.options-container');
  for(let i=0;i<options.length;i++){
    const optDiv = document.createElement('div');
    optDiv.style.display='flex'; optDiv.style.marginBottom='4px';
    optDiv.innerHTML = `
      <input type="text" class="opt-text" placeholder="Option text" value="${options[i]}" style="flex:1;margin-right:4px;">
      <label>Correct? <input type="radio" name="correct-${Date.now()}" ${i===correct?'checked':''}></label>
    `;
    optionsContainer.appendChild(optDiv);
  }
  
  qDiv.querySelector('.remove-q').addEventListener('click',()=>qDiv.remove());
  container.appendChild(qDiv);
}
addQuestion();
document.getElementById('add-question').addEventListener('click',()=>addQuestion());
document.getElementById('clear-builder').addEventListener('click',()=>{
  container.innerHTML=''; document.getElementById('quiz-title').value=''; addQuestion();
});
document.getElementById('save-quiz').addEventListener('click',()=>{
  const title = document.getElementById('quiz-title').value.trim() || 'Quiz '+Date.now();
  const questionBlocks = container.querySelectorAll('.question-block');
  const questions = [];
  questionBlocks.forEach(qb=>{
    const qText = qb.querySelector('.q-text').value.trim();
    const opts = qb.querySelectorAll('.opt-text');
    const radios = qb.querySelectorAll('input[type=radio]');
    if(!qText) return;
    const choices = [];
    let answer = 0;
    opts.forEach((o,i)=>{ choices.push(o.value.trim()||'Option '+(i+1)); if(radios[i].checked) answer=i; });
    questions.push({question:qText, choices, answer});
  });
  if(!questions.length) return alert('Add at least one question!');
  quizzes.push({id:'q_'+Date.now(), title, questions});
  localStorage.setItem('quizarcade_quizzes_v3', JSON.stringify(quizzes));
  refreshQuizList();
  alert('Quiz saved!');
});

// Game launching placeholders
function launchGame(mode){
  const selectedQuizId = quizList.value;
  if(!selectedQuizId) return alert('Select a quiz first!');
  const quiz = quizzes.find(q=>q.id===selectedQuizId);
  document.getElementById('game-title').textContent = `${mode.toUpperCase()} - ${quiz.title}`;
  document.getElementById('game-content').innerHTML = `<p>Game logic for ${mode} goes here. Quiz has ${quiz.questions.length} questions.</p>`;
  showPanel('game-container');
}
function exitGame(){ showPanel('view-play'); }
</script>

</body>
</html>
